{% extends 'dashboard.html' %}
{% load static %}

{% block search %}
<div class="navbar-menu-wrapper navbar-search-wrapper d-none d-lg-flex align-items-center">
  <ul class="navbar-nav mr-lg-2">
    <li class="nav-item nav-search d-none d-lg-block">
      <div class="input-group">
        <input type="text" class="form-control" placeholder="Search Here..." aria-label="search" aria-describedby="search">
      </div>
    </li>
  </ul>
</div>
{% endblock search %}

{% block content %}
<div class="main-panel">
  <div class="content-wrapper">
    <div class="row">
      <!-- Main Dashboard Content -->
      <div class="col-12 col-xl-8 grid-margin stretch-card">
        <div class="card">
          <div class="card-body">

            {% if user_type == 'patient' %}
            <!-- Patient Dashboard -->
            <div class="row">
              <div class="col-md-4 grid-margin stretch-card">
                <div class="card bg-primary text-white">
                  <div class="card-body">
                    <h3>Your Profile</h3>
                    <p>{{ user.email }}</p>
                    <a href="{% url 'core_app:profile' %}" class="btn btn-light">Edit Profile</a>
                  </div>
                </div>
              </div>
              
              <div class="col-md-4 grid-margin stretch-card">
                <div class="card bg-success text-white">
                  <div class="card-body">
                    <h3>Find Specialists</h3>
                    <p>Search by specialty or location</p>
                    <a href="{% url 'specialist_search' %}" class="btn btn-light">Search</a>
                  </div>
                </div>
              </div>
              
              <div class="col-md-4 grid-margin stretch-card">
                <div class="card bg-info text-white">
                  <div class="card-body">
                    <h3>Messages</h3>
                    <p>
                      {% if unread_messages %}
                        {{ unread_messages }} unread message{% if unread_messages > 1 %}s{% endif %}
                      {% else %}
                        No unread messages
                      {% endif %}
                    </p>
                    <a href="{% url 'inbox' %}" class="btn btn-light">View</a>
                  </div>
                </div>
              </div>
            </div>
            
            {% elif user_type == 'specialist' %}
            <!-- Specialist Dashboard -->
            <div class="row">
              <div class="col-md-4 grid-margin stretch-card">
                <div class="card bg-primary text-white">
                  <div class="card-body">
                    <h3>Your Profile</h3>
                    <p>{{ specialty.name|default:"General Practice" }}</p>
                    <a href="{% url 'core_app:profile' %}" class="btn btn-light">Edit Profile</a>
                  </div>
                </div>
              </div>
              
              <div class="col-md-4 grid-margin stretch-card">
                <div class="card bg-warning text-white">
                  <div class="card-body">
                    <h3>Your Patients</h3>
                    <p>Manage your patient list</p>
                    <a href="{% url 'core_app:patients' %}" class="btn btn-light">View Patients</a>
                  </div>
                </div>
              </div>
              
              <div class="col-md-4 grid-margin stretch-card">
                <div class="card bg-info text-white">
                  <div class="card-body">
                    <h3>Messages</h3>
                    <p>
                      {% if unread_messages %}
                        {{ unread_messages }} unread message{% if unread_messages > 1 %}s{% endif %}
                      {% else %}
                        No unread messages
                      {% endif %}
                    </p>
                    <a href="{% url 'inbox' %}" class="btn btn-light">View</a>
                  </div>
                </div>
              </div>
            </div>
            {% endif %}
          </div>
        </div>
      </div>

      <!-- Analytics Sidebar -->
      <div class="col-12 col-xl-4 grid-margin stretch-card">
        <div class="card">
          <div class="card-body">
            <p class="card-title">Platform Metrics</p>
            <p class="text-muted">25% more engagement than last week</p>
            
            <div class="row mb-3">
              <div class="col-md-12">
                <div class="d-flex justify-content-between traffic-status">
                  <div class="item">
                    <p class="mb-1">Active Users</p>
                    <h5 class="font-weight-bold mb-0">93,956</h5>
                  </div>
                  <div class="item">
                    <p class="mb-1">Engagement Rate</p>
                    <h5 class="font-weight-bold mb-0">72%</h5>
                  </div>
                  <div class="item">
                    <p class="mb-1">Sessions</p>
                    <h5 class="font-weight-bold mb-0">78,254</h5>
                  </div>
                </div>
              </div>
            </div>
            
            <div class="mb-3">
              <ul class="nav nav-pills nav-pills-custom" role="tablist">
                <li class="nav-item">
                  <a class="nav-link active" data-toggle="pill" href="#daily" role="tab">Daily</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" data-toggle="pill" href="#weekly" role="tab">Weekly</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" data-toggle="pill" href="#monthly" role="tab">Monthly</a>
                </li>
              </ul>
            </div>
            
            <canvas id="platform-metrics-chart" height="200"></canvas>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer class="footer">
    <div class="container-fluid">
      <div class="d-sm-flex justify-content-center justify-content-sm-between py-2">
        <span class="text-muted text-center text-sm-left d-block d-sm-inline-block">
          Copyright Â© <a href="#" target="_blank">MediCare</a> 2025
        </span>
        <span class="text-muted text-center text-sm-right d-block d-sm-inline-block">
          v2.1.0 | <a href="#">Privacy Policy</a>
        </span>
      </div>
    </div>
  </footer>
</div>
{% endblock content %}